-- REQUERIMIENTO 1

-- ADMINISTRADOR --

-- CREACIÓN DE PERFIL, USUARIO Y ROL

CREATE PROFILE MDY2131_1 LIMIT
CONNECT_TIME UNLIMITED
FAILED_LOGIN_ATTEMPTS 10
PASSWORD_LIFE_TIME 120;

CREATE USER MDY2131_P13_1 IDENTIFIED BY "MDY2131.practica_1"
DEFAULT TABLESPACE "DATA"
TEMPORARY TABLESPACE "TEMP"
PROFILE MDY2131_1;
ALTER USER MDY2131_P13_1 QUOTA UNLIMITED ON DATA;

GRANT CREATE SESSION TO MDY2131_P13_1;

CREATE ROLE ADMINISTRADOR;
GRANT ADMINISTRADOR TO MDY2131_P13_1;
ALTER USER MDY2131_P13_1 DEFAULT ROLE ADMINISTRADOR;

-- OTORGANDO PRIVILEGIOS

GRANT CREATE TABLE, CREATE VIEW, CREATE SEQUENCE, CREATE MATERIALIZED VIEW, DROP TABLESPACE, CREATE INDEXTYPE 
TO ADMINISTRADOR;

-- OTORGANDO ACCESO

GRANT UPDATE, DELETE ON MDY2131_P13_1.aporte_a_sbif TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.cliente TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.comuna TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.credito TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.credito_cliente TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.cuota_credito_cliente TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.forma_pago TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.movimiento TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.producto_inversion TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.producto_inversion_cliente TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.profesion_oficio TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.provincia TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.region TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.sucursal TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.tipo_contrato TO ADMINISTRADOR;
GRANT UPDATE, DELETE ON MDY2131_P13_1.tipo_movimiento TO ADMINISTRADOR;

-- SINÓNIMOS A TABLAS PÚBLICAS Y PRIVADAS

CREATE OR REPLACE SYNONYM SYN_APORTE_AL_SBIF
FOR MDY2131_P13_1.aporte_a_sbif;

CREATE OR REPLACE PUBLIC SYNONYM syn_clie
FOR MDY2131_P13_1.cliente;

CREATE OR REPLACE PUBLIC SYNONYM SYN_CO
FOR MDY2131_P13_1.comuna;

CREATE OR REPLACE SYNONYM SYN_CREDITOS
FOR MDY2131_P13_1.credito;

CREATE OR REPLACE PUBLIC SYNONYM syn_cred_clie
FOR MDY2131_P13_1.credito_cliente;

CREATE OR REPLACE PUBLIC SYNONYM SYN_CUOTAS_CREDITO_DE_CLIENTES
FOR MDY2131_P13_1.cuota_credito_cliente;

CREATE OR REPLACE SYNONYM SYN_FORMA_DE_PAGO
FOR MDY2131_P13_1.forma_pago;

CREATE OR REPLACE SYNONYM SYN_MOVIMIENTOS
FOR MDY2131_P13_1.movimiento;

CREATE OR REPLACE SYNONYM SYN_PRODUCTOS_DE_INVERSION
FOR MDY2131_P13_1.producto_inversion;

CREATE OR REPLACE PUBLIC SYNONYM SYN_PRODUCTOS_DE_INVERSION_CLIENTES
FOR MDY2131_P13_1.producto_inversion_cliente;

CREATE OR REPLACE SYNONYM SYN_PROFESION_OFICIOS
FOR MDY2131_P13_1.profesion_oficio;

CREATE OR REPLACE PUBLIC SYNONYM SYN_P
FOR MDY2131_P13_1.provincia;

CREATE OR REPLACE PUBLIC SYNONYM SYN_R
FOR MDY2131_P13_1.region;

CREATE OR REPLACE PUBLIC SYNONYM SYN_SUCURSALES
FOR MDY2131_P13_1.sucursal;

CREATE OR REPLACE PUBLIC SYNONYM SYN_TIPO_CONTRATOS
FOR MDY2131_P13_1.tipo_contrato;

CREATE OR REPLACE PUBLIC SYNONYM SYN_TIPO_MOVIMIENTOS
FOR MDY2131_P13_1.tipo_movimiento;

-- DESARROLLADORES INFORMÁTICOS --

-- CREACIÓN DE PERFIL, USUARIO Y ROL

CREATE PROFILE MDY2131_2 LIMIT
CONNECT_TIME 60
FAILED_LOGIN_ATTEMPTS 5
PASSWORD_LIFE_TIME 90
PASSWORD_LOCK_TIME 1;

CREATE USER MDY2131_P13_2 IDENTIFIED BY "MDY2131.practica_2"
DEFAULT TABLESPACE "DATA"
TEMPORARY TABLESPACE "TEMP"
PROFILE MDY2131_2;
ALTER USER MDY2131_P13_2 QUOTA UNLIMITED ON DATA;

GRANT CREATE SESSION TO MDY2131_P13_2;

CREATE ROLE DESARROLLADOR_INF_BANCARIO;
GRANT DESARROLLADOR_INF_BANCARIO TO MDY2131_P13_2;
ALTER USER MDY2131_P13_2 DEFAULT ROLE  DESARROLLADOR_INF_BANCARIO;

------------------------

CREATE PROFILE MDY2131_3 LIMIT
CONNECT_TIME 60
FAILED_LOGIN_ATTEMPTS 5
PASSWORD_LIFE_TIME 90
PASSWORD_LOCK_TIME 1;

CREATE USER MDY2131_P13_3 IDENTIFIED BY "MDY2131.practica_3"
DEFAULT TABLESPACE "DATA"
TEMPORARY TABLESPACE "TEMP"
PROFILE MDY2131_3;
ALTER USER MDY2131_P13_3 QUOTA UNLIMITED ON DATA;

GRANT CREATE SESSION TO MDY2131_P13_3;

GRANT DESARROLLADOR_INF_BANCARIO TO MDY2131_P13_3;
ALTER USER MDY2131_P13_3 DEFAULT ROLE  DESARROLLADOR_INF_BANCARIO;

-- OTORGANDO PRIVILEGIOS

GRANT CREATE PROCEDURE, CREATE TRIGGER, CREATE VIEW, CREATE MATERIALIZED VIEW 
TO DESARROLLADOR_INF_BANCARIO;

GRANT CREATE PROCEDURE, CREATE TRIGGER, CREATE VIEW, CREATE MATERIALIZED VIEW 
TO MDY2131_P13_3;

-- OTORGANDO ACCESO

GRANT SELECT ON MDY2131_P13_1.aporte_a_sbif TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.cliente TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.cliente TO MDY2131_P13_2, MDY2131_P13_3 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P13_1.comuna TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.comuna TO MDY2131_P13_3 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P13_1.credito TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.credito_cliente TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.credito_cliente TO MDY2131_P13_2 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P13_1.cuota_credito_cliente TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.forma_pago TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.movimiento TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.producto_inversion TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.producto_inversion_cliente TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.profesion_oficio TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.provincia TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.provincia TO MDY2131_P13_3 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P13_1.region TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.region TO MDY2131_P13_3 WITH GRANT OPTION;
GRANT SELECT ON MDY2131_P13_1.sucursal TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.tipo_contrato TO DESARROLLADOR_INF_BANCARIO;
GRANT SELECT ON MDY2131_P13_1.tipo_movimiento TO DESARROLLADOR_INF_BANCARIO;

GRANT UPDATE, INSERT, DELETE ON MDY2131_P13_1.credito_cliente TO DESARROLLADOR_INF_BANCARIO;
GRANT UPDATE, INSERT, DELETE ON MDY2131_P13_1.producto_inversion_cliente TO DESARROLLADOR_INF_BANCARIO;
GRANT UPDATE, INSERT, DELETE ON MDY2131_P13_1.cuota_credito_cliente TO DESARROLLADOR_INF_BANCARIO;

--- VISTAS

GRANT SELECT ON MDY2131_P13_2.V_TOTAL_CREDITOS_CLIENTE TO MDY2131_P13_3;

-- RECURSOS HUMANOS --

-- CREACIÓN DE PERFIL, USUARIO Y ROL

CREATE PROFILE MDY2131_4 LIMIT
CONNECT_TIME 120
IDLE_TIME 20
FAILED_LOGIN_ATTEMPTS 2
PASSWORD_LOCK_TIME 1
PASSWORD_LIFE_TIME 90
PASSWORD_GRACE_TIME 1;

CREATE USER MDY2131_P13_4 IDENTIFIED BY "MDY2131.practica_4"
DEFAULT TABLESPACE "DATA"
TEMPORARY TABLESPACE "TEMP"
PROFILE MDY2131_4;
ALTER USER MDY2131_P13_4 QUOTA 100 ON DATA;

GRANT CREATE SESSION TO MDY2131_P13_4;

CREATE ROLE RECURSOS_HUMANOS;
GRANT RECURSOS_HUMANOS TO MDY2131_P13_4;
ALTER USER MDY2131_P13_4 DEFAULT ROLE RECURSOS_HUMANOS;

-- OTORGANDO ACCESO

GRANT SELECT ON MDY2131_P13_1.cliente TO RECURSOS_HUMANOS;
GRANT SELECT ON MDY2131_P13_1.comuna TO RECURSOS_HUMANOS;
GRANT SELECT ON MDY2131_P13_1.provincia TO RECURSOS_HUMANOS;
GRANT SELECT ON MDY2131_P13_1.region TO RECURSOS_HUMANOS;
GRANT SELECT ON MDY2131_P13_1.sucursal TO RECURSOS_HUMANOS;
GRANT SELECT ON MDY2131_P13_1.tipo_contrato TO RECURSOS_HUMANOS;
GRANT SELECT ON MDY2131_P13_1.tipo_movimiento TO RECURSOS_HUMANOS;

-- VISTAS

GRANT SELECT ON MDY2131_P13_3.V_DATOS_CLIENTES TO MDY2131_P13_4;

-- ENCARGADOS DE TRANSACCIÓN DE CLIENTES --

-- CREACIÓN DE PERFIL, USUARIO Y ROL

CREATE PROFILE MDY2131_5 LIMIT
CONNECT_TIME 120
IDLE_TIME 20
FAILED_LOGIN_ATTEMPTS 2
PASSWORD_LOCK_TIME 1
PASSWORD_LIFE_TIME 90
PASSWORD_GRACE_TIME 1;

CREATE USER MDY2131_P13_5 IDENTIFIED BY "MDY2131.practica_5"
DEFAULT TABLESPACE "DATA"
TEMPORARY TABLESPACE "TEMP"
PROFILE MDY2131_5;
ALTER USER MDY2131_P13_5 QUOTA 100 ON DATA;

GRANT CREATE SESSION TO MDY2131_P13_5;

CREATE ROLE TRANSACCION_CLIENTES;
GRANT TRANSACCION_CLIENTES TO MDY2131_P13_5;
ALTER USER MDY2131_P13_5 DEFAULT ROLE TRANSACCION_CLIENTES;

------------------------

CREATE PROFILE MDY2131_6 LIMIT
CONNECT_TIME 120
IDLE_TIME 20
FAILED_LOGIN_ATTEMPTS 2
PASSWORD_LOCK_TIME 1
PASSWORD_LIFE_TIME 90
PASSWORD_GRACE_TIME 1;

CREATE USER MDY2131_P13_6 IDENTIFIED BY "MDY2131.practica_6"
DEFAULT TABLESPACE "DATA"
TEMPORARY TABLESPACE "TEMP"
PROFILE MDY2131_6;
ALTER USER MDY2131_P13_6 QUOTA 100 ON DATA;

GRANT CREATE SESSION TO MDY2131_P13_6;

GRANT TRANSACCION_CLIENTES TO MDY2131_P13_6;
ALTER USER MDY2131_P13_6 DEFAULT ROLE TRANSACCION_CLIENTES;

-- OTORGANDO ACCESO

GRANT SELECT ON MDY2131_P13_1.cliente TO TRANSACCION_CLIENTES;
GRANT SELECT ON MDY2131_P13_1.comuna TO TRANSACCION_CLIENTES;
GRANT SELECT ON MDY2131_P13_1.provincia TO TRANSACCION_CLIENTES;
GRANT SELECT ON MDY2131_P13_1.region TO TRANSACCION_CLIENTES;










